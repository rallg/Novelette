%%
%% This is file Novelette-Settings.sty,
%% part of Novelette document class.
%% Copyright 2022 Robert Allgeyer.
%%
%% It may be used, distributed, and/or modified under the
%% conditions of the MIT License. See:
%% https://opensource.org/licenses/MIT
%%
%%
\ProvidesFile{Novelette-Settings.sty}%
[2022/06/22 v0.0.1 LuaLaTeX file (layout settings)]
%%


%% Define \purpose{book,markup,cover}:
\newif \if@book
\newif \if@coverart
\newif \if@markupcopy
\newcommand\purpose[1]{
  \@tempTFfalse
  \ifthenelse{\equal{#1}{book}}{\@booktrue \@tempTFtrue}{}
  \ifthenelse{\equal{#1}{cover}}{\@coverarttrue \@tempTFtrue}{}
  \ifthenelse{\equal{#1}{markup}}{\@markupcopytrue \@tempTFtrue}{}
  \if@tempTF\else
    \ClassError{Novelette}{Bad choice in \string\purpose{choice}}%
    {Available choices:  book  markup  cover }
  \fi
}
\purpose{book} % Default.

%% Define \template{number}{name}:
\newif \if@templateset
\newcommand\template[2]{%
  \gdef\my@template{#1}
  \gdef\my@trimname{#2}
  \IfSubStr{1 2 3}{\my@template}{}{%
    \ClassError{Novelette}{Incorrect choice of template number}%
    {In \string\template{number}{name} number must be 1, 2, or 3.}%
  }
  \IfSubStr{Novella B Memoir Demy Digest Trade Royal}{\my@trimname}{}{%
    \ClassError{Novelette}{Incorrect choice of size name}%
    {In \string\template{number}{name} name must be one of: ^^J%
     Novella B Memoir Demy Digest Trade Royal ^^J%
     The name is case-sensitive.}%
  }
  \@templatesettrue
}
%%

%% Define \upshift{number} Tweak: Moves bottom of text up 0 to 2 lines.
\newcommand\upshift[1]{ %  Number 0-2. May be decimal.
  \@tempTFtrue
  \FPiflt{#1}{0}\@tempTFfalse\fi
  \FPifgt{#1}{2}\@tempTFfalse\fi
  \if@tempTF
    \gdef\my@upshift{#1}
  \else
    \ClassError{Novelette}{Bad value in \string\upshift{}}*
    {Value 0 - 2. May be decimal.}%
  \fi
}
\upshift{0} % Default.
%%

%% Define \media{book,markup}{width}{height} :
\newif \if@MediaSize % When trim size is floated in larger PDF page size.
\DeclareDocumentCommand\media { m m m O{none} } {
  \@tempTFfalse
  \ifthenelse{\equal{#1}{book}}{\@tempTFtrue}{}
  \ifthenelse{\equal{#1}{markup}}{\@tempTFtrue}{}
  \if@tempTF\else
    \ClassError{Novelette}{Bad choice for \string\media{}{}{}}%
    {First argument:  book  markup}%
  \fi
  \@tempTFfalse
  \IfEndWith{#2}{in}{\@tempTFtrue}{}
  \IfEndWith{#2}{mm}{\@tempTFtrue}{}
  \IfEndWith{#2}{cm}{\@tempTFtrue}{}
  \if@tempTF\else
    \ClassError{Novelette}{Bad choice for \string\media{}{}{}}%
    {Second argument must be width. Units: mm cm in}%
  \fi
  \@tempTFfalse
  \IfEndWith{#3}{in}{\@tempTFtrue}{}
  \IfEndWith{#3}{mm}{\@tempTFtrue}{}
  \IfEndWith{#3}{cm}{\@tempTFtrue}{}
  \if@tempTF\else
    \ClassError{Novelette}{Bad choice for \string\media{}{}{}}%
    {Third argument must be height. Units: mm cm in}%
  \fi
  \ifthenelse{\dimtest{#2}{<}{#3}}{
    \ifthenelse{\equal{#1}{book}}{
      \if@book
        \@MediaSizetrue
        \gsetlength\paperwidth{#2}
        \gsetlength\paperheight{#3}
      \fi
    }{}
    \ifthenelse{\equal{#1}{markup}}{
      \if@markupcopy
        \@MediaSizetrue
        \gsetlength\paperwidth{#2}
        \gsetlength\paperheight{#3}
      \fi
    }{}
  }{
    \ClassError{Novelette}{Bad choice for \string\media{}{}{}}%
    {Second argument is width. Third argument is height. ^^J%
     Height must be greater than width.}
  }
}
%%

%% \header{verso or recto}{header text}
%% Except on certain pages (such as chapter start, Copyright, etc.),
%% all pages of running text have a visible header. This defines its text.
%% Header text is at Scale=0.88 and loose tracking, relative to main body text.
%% Page number and emblem are added automatically.
%% You may change header text as the book proceeds.
\newcommand\header[2]{
  \@tempTFfalse
  \ifthenelse{\equal{#1}{verso}}{
    \@tempTFtrue
    \gdef\my@versoheader{#2}
  }{}
  \ifthenelse{\equal{#1}{recto}}{
    \@tempTFtrue
    \gdef\my@rectoheader{#2}
  }{}
  \if@tempTF\else
    \ClassError{Novelette}{Bad first argument for \string\header}%
    {For first argument, choose:  verso recto}
  \fi
}
\header{verso}{placeholder} % Changed later.
\header{recto}{placeholder} % Changed later.
%%

%% Emblem is placed next to page number. Choices: none slash bar curve
%%   none, or empty \emblem{} : no emblem.
%%   slash : symmetrical slash (verso) and backslash (recto). Default.
%%   bar : vertical bar
%%   curve : like parentheses, symmetrical verso-recto.
%% These names refer to special characters in Swainson. No other choices.
\newcommand\emblem[1]{ % First argument, verso recto. Second argument, content.
  \@tempTFfalse
  \ifthenelse{\equal{#1}{none} \OR \equal{#1}{}}{
    \@tempTFtrue
    \gdef\my@versoemblem{~}
    \gdef\my@rectoemblem{~}
  }{}
  \ifthenelse{\equal{#1}{slash}}{
    \@tempTFtrue
    \gdef\my@versoemblem{\addfontfeature{StylisticSet=48}/}
    \gdef\my@rectoemblem{\addfontfeature{StylisticSet=48}\textbackslash}
  }{}
  \ifthenelse{\equal{#1}{bar}}{
    \@tempTFtrue
    \gdef\my@versoemblem{\addfontfeature{StylisticSet=48}|}
    \gdef\my@rectoemblem{\addfontfeature{StylisticSet=48}|}
  }{}
  \ifthenelse{\equal{#1}{curve}}{
    \@tempTFtrue
    \gdef\my@versoemblem{\addfontfeature{StylisticSet=48})}
    \gdef\my@rectoemblem{\addfontfeature{StylisticSet=48}(}
  }{}
  \if@tempTF\else
    \ClassError{Novelette}{Bad choice for \string\emblem}%
     {Choices:  none  slash  bar  curve}
  \fi
}
\emblem{slash} % Default.
%%

%% This is used only by developer. Not part of release:
\newcommand\markupgrid[1]{}
\gdef\my@developer@grid{}
\InputIfFileExists{Novelette-Developer.sty}{}{}
%%



%%
\endinput
%%
%% End of file Novelette-CalculateLayout.sty.
